<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>è¯¾ç¨‹çŠ¶æ€</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .status-box {
            background: #fff;
            border: 2px solid #ccc;
            padding: 20px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .current-status {
            font-size: 24px;
            color: #333;
            margin-bottom: 10px;
        }
        .time-left {
            font-size: 18px;
            color: #666;
        }
        .settings {
            margin: 20px 0;
            background: #fff;
            padding: 15px;
            border: 1px solid #ddd;
        }
        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
        }
        .schedule-table td, .schedule-table th {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .highlight {
            background-color: #e6f3ff;
        }
    </style>
</head>
<body>
    <div class="status-box">
        <div class="current-status" id="statusText">çŠ¶æ€æ£€æµ‹ä¸­...</div>
        <div class="time-left" id="timeLeft"></div>
    </div>

    <div class="settings">
        <label>
            <input type="checkbox" id="classBell"> ä¸Šè¯¾æ’­æ”¾é“ƒå£°
        </label>
        <br>
        <label>
            <input type="checkbox" id="breakBell"> ä¸‹è¯¾æ’­æ”¾é“ƒå£°
        </label>
    </div>

    <table class="schedule-table" id="scheduleTable">
        <tr>
            <th>è¯¾ç¨‹åç§°</th>
            <th>å¼€å§‹æ—¶é—´</th>
            <th>ç»“æŸæ—¶é—´</th>
        </tr>
    </table>

    <script>
        // è¯¾ç¨‹é…ç½®
        var schedule = [
            { name: "ä¸Šè¯¾", start: "2025-02-04T08:00", end: "2025-02-04T08:50" },
            { name: "ä¸Šè¯¾", start: "2025-02-04T09:00", end: "2025-02-04T09:50" },
            { name: "ä¸Šè¯¾", start: "2025-02-04T10:10", end: "2025-02-04T11:00" },
            { name: "ä¸Šè¯¾", start: "2025-02-04T11:10", end: "2025-02-04T12:00" }
        ];

        // è§£ææ—¥æœŸæ—¶é—´ï¼ˆå…¼å®¹è€æµè§ˆå™¨ï¼‰
        function parseDateTime(datetimeStr) {
            var parts = datetimeStr.split(/[-T:]/);
            return new Date(
                parts[0], parts[1]-1, parts[2],
                parts[3], parts[4], 0
            );
        }

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus() {
            var now = new Date();
            var currentClass = null;
            var nextClass = null;
            
            // æŸ¥æ‰¾å½“å‰è¯¾ç¨‹å’Œä¸‹ä¸€ä¸ªè¯¾ç¨‹
            for (var i = 0; i < schedule.length; i++) {
                var start = parseDateTime(schedule[i].start);
                var end = parseDateTime(schedule[i].end);
                
                if (now >= start && now <= end) {
                    currentClass = schedule[i];
                    break;
                }
                if (now < start) {
                    nextClass = schedule[i];
                    break;
                }
            }

            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
            var statusText = document.getElementById('statusText');
            var timeLeft = document.getElementById('timeLeft');
            
            if (currentClass) {
                statusText.innerHTML = "ä¸Šè¯¾ä¸­ ğŸ’";
                statusText.style.color = "#c00";
                var remain = parseDateTime(currentClass.end) - now;
                timeLeft.innerHTML = formatTime(remain);
            } else if (nextClass) {
                statusText.innerHTML = "ä¸‹è¯¾ä¸­ ğŸ•’";
                statusText.style.color = "#090";
                var remain = parseDateTime(nextClass.start) - now;
                timeLeft.innerHTML = "è·ç¦»ä¸Šè¯¾ï¼š" + formatTime(remain);
            } else {
                statusText.innerHTML = "ä»Šæ—¥è¯¾ç¨‹å·²ç»“æŸ ğŸ‰";
                timeLeft.innerHTML = "";
            }
        }

        // æ ¼å¼åŒ–å‰©ä½™æ—¶é—´
        function formatTime(milliseconds) {
            var seconds = Math.floor(milliseconds / 1000);
            var minutes = Math.floor(seconds / 60);
            seconds = seconds % 60;
            return minutes + "åˆ†" + (seconds < 10 ? "0" : "") + seconds + "ç§’";
        }

        // åˆå§‹åŒ–è¯¾ç¨‹è¡¨
        function initSchedule() {
            var table = document.getElementById('scheduleTable');
            schedule.forEach(function(cls) {
                var row = table.insertRow(-1);
                row.innerHTML = '<td>' + cls.name + '</td>' +
                                '<td>' + cls.start.split('T')[1] + '</td>' +
                                '<td>' + cls.end.split('T')[1] + '</td>';
            });
        }

        // åˆå§‹åŒ–è®¾ç½®
        function initSettings() {
            document.getElementById('classBell').checked = 
                localStorage.getItem('classBell') !== 'false';
            document.getElementById('breakBell').checked = 
                localStorage.getItem('breakBell') !== 'false';

            document.getElementById('classBell').onchange = function() {
                localStorage.setItem('classBell', this.checked);
            };
            document.getElementById('breakBell').onchange = function() {
                localStorage.setItem('breakBell', this.checked);
            };
        }

        // åˆå§‹åŒ–
        function init() {
            initSchedule();
            initSettings();
            setInterval(updateStatus, 1000);
            updateStatus();
        }

        init();
    </script>
</body>
</html>
